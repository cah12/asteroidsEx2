define(["jquery","services"],function(e,t){function o(t){t?(e("#gameViewDiv").hide(),n.show(),e(window).trigger("gameView",!1)):(e("#gameViewDiv").show(),n.hide(),e(window).trigger("gameView",!0))}function u(t){e("#profileRealName").text(t.meta.firstname+" "+t.meta.lastname),e("#profileUsername").text(t.username),e("#profileEmail").attr("href","mailto:"+t.meta.email),t.meta.last_visitor?(e("#lastVisitorName").text(t.meta.last_visitor.name),e("#lastVisitorEmail").prop("href","mailto:"+t.meta.last_visitor.email),e("#lastVisitorEmail").text("("+t.meta.last_visitor.email+")"),e("#lastVisitorDate").text(new Date(t.meta.last_visitor.date))):(e("#lastVisitorName").text(""),e("#lastVisitorEmail").text(""),e("#lastVisitorDate").text("")),e("#profileHobby").text(t.meta.hobby),e("#profileCountry").text(t.meta.country),e("#profileOccupation").text(t.meta.occupation),e("#profileLastUpdate").text(new Date(t.updated_at)),e("#profileCreatedAt").text(new Date(t.created_at))}function a(t){t?(e("#gameViewDiv").hide(),s.show(),e(window).trigger("gameView",!1)):(e("#gameViewDiv").show(),s.hide(),e(window).trigger("gameView",!0))}function f(e){e?(s.hide(),r.show()):(s.show(),r.hide())}function l(t){t?(e("#changePasswordMsg").hide(),s.hide(),i.show()):(s.show(),i.hide())}var n=e('<div class="page-header text-center"><h1><span class="fa fa-anchor"></span> Leader Profile</h1><a href="#" id="leaderProfileBackToGame" class="btn btn-default btn-sm">Back to game</a></div><div class="row"><div class="col-xs-12"><div class="well"><h3><span class="fa fa-user"></span> Local</h3><p><strong>Real name</strong>: <span id="leaderProfileRealName"></span><br><strong>username</strong>: <span id="leaderProfileUsername"></span><br><strong>email</strong>: <a id="leaderProfileEmail"></a><br><strong>Occupation</strong>: <span id="leaderProfileOccupation"></span><br><strong>Hobby</strong>: <span id="leaderProfileHobby"></span><br><strong>Country</strong>: <span id="leaderProfileCountry"></span><br><strong>Created at</strong>: <span id="leaderProfileCreatedAt"></span><br><strong>Last update</strong>: <span id="leaderProfileLastUpdate"></span></p></div></div></div>');e("#maincontainer").append(n),n.hide();var r=e('<div class="row"><div class="col-md-6 col-md-offset-3"><h2 class="text-center">Edit your profile</h2><div class="well"><form action="" method="post"><div class="form-group has-feedback"><label class="control-label" for="firstname">Firstname</label><input id="editProfileFirstName" type="text" class="form-control" name="firstname"><span class="glyphicon glyphicon-remove form-control-feedback hide"></span></div><div class="form-group has-feedback"><label class="control-label" for="lastname">Lastname</label><input id="editProfileLastName" type="text" class="form-control" name="lastname"><span class="glyphicon glyphicon-remove form-control-feedback hide"></span></div><div class="form-group has-feedback"><label class="control-label" for="email">email</label><input id="editProfileEmail" type="email" class="form-control" name="email"><span class="glyphicon glyphicon-remove form-control-feedback hide"></span></div><div class="form-group has-feedback"><label class="control-label" for="occupation">Occupation</label><input id="editProfileOccupation" type="text" class="form-control" name="occupation"><span class="glyphicon glyphicon-remove form-control-feedback hide"></span></div><div class="form-group has-feedback"><label class="control-label" for="hobby">Hobby</label><input id="editProfileHobby" type="text" class="form-control" name="hobby"><span class="glyphicon glyphicon-remove form-control-feedback hide"></span></div><div class="form-group has-feedback"><label class="control-label" for="country">Country</label><input id="editProfileCountry" type="text" class="form-control" name="country"><span class="glyphicon glyphicon-remove form-control-feedback hide"></span></div><input id="editProfileSave" type="button" value="Save" class="btn btn-lg btn-primary"><input id="editProfileCancel" type="reset" value="Cancel" class="btn btn-lg btn-primary"></form></div></div></div>');e("#maincontainer").append(r),r.hide();var i=e('<div class="row"><div class="col-md-6 col-md-offset-3"><h2 class="text-center">Change password</h2><div class="well"><form><div class="form-group has-feedback"><label class="control-label" for="oldPassword">Old password</label><input id="oldPassword" type="password" class="form-control" name="oldPassword"><span class="glyphicon glyphicon-remove form-control-feedback hide"></span></div><div class="form-group has-feedback"><label class="control-label" for="newPassword">New password</label><input id="newPassword" type="password" class="form-control" name="newPassword"><span class="glyphicon glyphicon-remove form-control-feedback hide"></span></div><div class="form-group has-feedback"><label class="control-label" for="confirmPassword">Confirm password</label><input id="confirmPassword" type="password" class="form-control" name="confirmPassword"><span class="glyphicon glyphicon-remove form-control-feedback hide"></span></div><input id="changePasswordChange" type="button" value="Change" class="btn btn-lg btn-primary"><input id="changePasswordCancel" type="reset" value="Cancel" class="btn btn-lg btn-primary"><span id="changePasswordMsg" style="color: red; font-size: 100%"> Ooops... invalid entry!</span></form></div></div></div>');e("#maincontainer").append(i),i.hide();var s=e('<div class="page-header text-center"><h1><span class="fa fa-anchor"></span> User Profile</h1><a href="#" id="logout" class="btn btn-default btn-sm">Logout</a><a href="#" id="editProfile" class="btn btn-default btn-sm">Edit profile</a><a href="#" id="changePassword" class="btn btn-default btn-sm">Change password</a><a href="#" id="backToGame" class="btn btn-default btn-sm">Back to game</a></div><div class="row"><div class="col-xs-12"><div class="well"><h3><span class="fa fa-user"></span> Local</h3><p><strong>Real name</strong>: <span id="profileRealName"></span><br><strong>username</strong>: <span id="profileUsername"></span><br><strong>Occupation</strong>: <span id="profileOccupation"></span><br><strong>Hobby</strong>: <span id="profileHobby"></span><br><strong>Country</strong>: <span id="profileCountry"></span><br><strong>Created at</strong>: <span id="profileCreatedAt"></span><br><strong>Last update</strong>: <span id="profileLastUpdate"></span><br><br><strong>Last visitor</strong>: <span id="lastVisitorName"></span><a id="lastVisitorEmail"></a><br><strong>Time of visit</strong>: <span id="lastVisitorDate"></span><br></p></div></div></div>');e("#maincontainer").append(s),s.hide(),e("#name_href").click(function(){t.leaderProfile(function(t,n){e("#leaderProfileRealName").text(t.meta.firstname+" "+t.meta.lastname),e("#leaderProfileUsername").text(t.username),e("#leaderProfileEmail").attr("href","mailto:"+t.meta.email),e("#leaderProfileEmail").text(t.meta.email),e("#leaderProfileHobby").text(t.meta.hobby),e("#leaderProfileCountry").text(t.meta.country),e("#leaderProfileOccupation").text(t.meta.occupation),e("#leaderProfileLastUpdate").text(new Date(t.updated_at)),e("#leaderProfileCreatedAt").text(new Date(t.created_at)),o(!0)})}),e("#leaderProfileBackToGame").click(function(){o(!1)}),e("#profile").click(function(){t.profile(function(e,t){u(e),a(!0)})}),e("#backToGame").click(function(){a(!1)}),e("#logout").click(function(){t.logout(function(t,n){e("#authenticatedSpan").hide(),e("#notAuthenticatedSpan").show(),e("#name_href").hide(),e("#name").show(),a(!1)})}),e("#editProfile").click(function(){t.profile(function(t,n){e("#editProfileFirstName").val(t.meta.firstname),e("#editProfileLastName").val(t.meta.lastname),e("#editProfileHobby").val(t.meta.hobby),e("#editProfileOccupation").val(t.meta.occupation),e("#editProfileCountry").val(t.meta.country),e("#editProfileEmail").val(t.meta.email),f(!0)})}),e("#editProfileSave").click(function(){t.editProfile({firstname:e("#editProfileFirstName").val(),lastname:e("#editProfileLastName").val(),hobby:e("#editProfileHobby").val(),occupation:e("#editProfileOccupation").val(),country:e("#editProfileCountry").val(),email:e("#editProfileEmail").val(),updated_at:new Date},function(e,n){t.profile(function(e){u(e),f(!1)})})}),e("#editProfileCancel").click(function(){f(!1)}),e("#changePassword").click(function(){l(!0)}),e("#changePasswordChange").click(function(){t.changePassword({oldPassword:e("#oldPassword").val(),newPassword:e("#newPassword").val(),confirmPassword:e("#confirmPassword").val()},function(t,n){t.id!==undefined?l(!1):e("#changePasswordMsg").show(),e("input[type=password], textarea").val("")})}),e("#changePasswordCancel").click(function(){l(!1)}),f(!1),l(!1),a(!1),o(!1)});