define([],function(){var e=function(e,t){var n=this;this.loop=!0;var r=!1,i=!1;this.details=t=t||{},this.run=t.run=t.run||!1,this.scale=t.scale=t.scale||1,this.id=t.id=t.id||"",this.x=t.x=t.x||0,this.y=t.y=t.y||0,this.rowNumber=t.rowNumber=t.rowNumber||0,this.angle=t.angle=t.angle||0;var s=t.width=t.width||100,o=t.height=t.height||100,u=t.imageSrc=t.imageSrc||undefined,a=0,f=0,l=t.ticksPerFrame=t.ticksPerFrame||4,c=t.numberOfFrames=t.numberOfFrames||1,h=t.numberOfRows=t.numberOfRows||1,p=$("<canvas>");p[0].width=e.element.width,p[0].height=e.element.height;var d=e.element.parentNode;d.insertBefore(p[0],d.childNodes[0]),p[0].style.position="absolute";var v=p[0].getContext("2d"),m=null;if(typeof u=="string")m=new Image,m.src=u;else{m=u;if(m===undefined)throw"AnimateSprite: unable to resolve image"}this.render=function(){v.save(),v.clearRect(0,0,p.width(),p.height()),v.translate(n.x,n.y),v.rotate(n.angle*Math.PI/180),v.scale(n.scale,n.scale),v.drawImage(m,a*s/c,o/h*n.rowNumber,s/c,o/h,0,0,s/c,o/h),v.restore()},this.update=function(){f+=1,f>l&&(f=0,a<c-1?a+=1:n.loop&&(a=0))},$(window).on("step",function(){n.run?(n.update(),n.render(),i=!0):i||(n.render(),i=!0)}),this.toString=function(){return"[AnimateSprite]"}};return e});